<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    FetchAxios
    <input type="file" id="file" ref="file" multiple style="display: none" />

    <button>点我上传示例</button>
    <script type="module">

        import { CaseFetchAxios } from "./FetchAxios.js"
        import AbortRequest from "../AbortRequest/AbortRequest.js"
        const abortRequest = new AbortRequest();


        // --------------------1.post 测试--------------------
        CaseFetchAxios.create({ BaseUrl: "http://localhost:8088",TimeOut:10000 })
        // CaseFetchAxios.BaseConfig.BeforeRequest = (config)=>{
        //     console.log("config:",config)
        //     return config
        // }
        // console.log(CaseFetchAxios)
        // CaseFetchAxios.request({
        //     url:"/api/post",
        //     data:{
        //         id:565656
        //     },
        //     method:"POST",
        //     headers:{
        //         // 不加 这行 就是 返回字符串
        //         // "content-type":"application/json"
        //     }
        // }).then((e)=>{
        //     return e.json()
        // }).then((e)=>{
        //     console.log("最终结果:",e)
        // })

        // --------------------2.get 测试 --------------------
        // get 中 加上 Content-Type 也会被视为是 复杂请求触发 option 跨域
        CaseFetchAxios.request({
            url:"/api/g22et",
            data:{
                id:5656588888
            },
            method:"GET",
            headers:{
                // "Content-Type":"application/json",
            },
        }).then((e)=>{
            console.log("e:",e)
            return e.json()
        }).then((e)=>{
            console.log("最终结果:",e)
        })
     
        // --------------------3.文件上传测试--------------------
        // let fileDom = document.querySelector("#file")
        // fileDom.addEventListener("change",async(e)=>{

        //     const data = new FormData();
        //     data.append("file", e.target.files[0]);
        //     console.log(data,e.target.files[0])
        //     CaseFetchAxios.request({
        //         url:"/api/file",
        //         data:data,
        //         method:"POST",
        //         headers:{
        //             // 这玩意不用加.因为在实际开发中，浏览器会自动帮你加上 boundary
        //             // "Content-Type": 'multipart/form-data'
        //         },
        //     }).then((e)=>{
        //         console.log("e:",e)
        //         return e.json()
        //     }).then((e)=>{
        //         console.log("最终结果:",e)
        //     })
        // })

        // document.querySelector("button").addEventListener("click",()=>{
        //     fileDom.click()
        // })

        // ---------------------4. signal 测试--------------------
        // let testSignal = abortRequest.create("signal测试");
        // CaseFetchAxios.request({
        //     url: "/api/get",
        //     data: {
        //         id: 5656588888
        //     },
        //     signal: testSignal,
        //     method: "GET",
        //     headers: {
        //         // "Content-Type":"application/json",
        //     },
        //     mode: 'cors'
        // }).then((e) => {
        //     console.log("e:", e)
        //     return e.json()
        // }).then((e) => {
        //     console.log("最终结果:", e)
        //     abortRequest.remove("signal测试")
        // })
        // setTimeout(() => {
        //     testSignal = abortRequest.create("signal测试");
        //     CaseFetchAxios.request({
        //         url: "/api/get",
        //         data: {
        //             id: 5656588888
        //         },
        //         signal: testSignal,
        //         method: "GET",
        //         headers: {
        //             // "Content-Type":"application/json",
        //         },
        //     }).then((e) => {
        //         console.log("e:", e)
        //         return e.json()
        //     }).then((e) => {
        //         console.log("最终结果:", e)
        //     })
        // }, 3500);

        // ---------------------5. sse 测试-------------------- 
        // CaseFetchAxios.request({
        //     url: "/api/sse",
        //     data: {
        //         id: 5656588888
        //     },
        //     method: "GET",
        //     headers: {
        //         // "Content-Type":"application/json",
        //     },
        //     mode: 'cors'
        // }).then(async (e) => {
        //     console.log("e:", e)
        //     const reader = e.body.getReader();

        //     while (true) {
        //         const { done, value } = await reader.read();
        //         console.log(`Received  bytes`, done, value)
        //         if (done) {
        //             break;
        //         }
        //     }
        // }).then((e) => {
        //     console.log("最终结果:", e)
        // })


            // CaseFetchAxios.request({
        //     url: "/api/sse",
        //     data: {
        //         id: 5656588888
        //     },
        //     method: "GET",
        //     headers: {
        //         // "Content-Type":"application/json",
        //     },
        //     mode: 'cors'
        // }).then(async (e) => {
        //     console.log("e:", e)
        //     const reader = e.body.getReader();

        //     while (true) {
        //         const { done, value } = await reader.read();
        //         console.log(`Received  bytes`, done, value)
        //         if (done) {
        //             break;
        //         }
        //     }
        // }).then((e) => {
        //     console.log("最终结果:", e)
        // })
//         CaseFetchAxios.create({ BaseUrl: "https://dashscope.aliyuncs.com" })
//              CaseFetchAxios.request({
//             url: "/api/v1/services/aigc/text-generation/generation",
//             data: {
//     "model": "qwen-turbo",
//     "input": {
//         "messages": [
//             {
//                 "role": "system",
//                 "content": "You are a helpful assistant."
//             },
//             {
//                 "role": "user",
//                 "content": "你好，哪个公园距离我最近？"
//             }
//         ]
//     },
// },
//             method: "POST",
//             headers: {
//                 "Authorization":"sk-9c9c0e52316647869f37dd97dc65669f",
//                 "Content-Type":"application/json"
//             },
//             mode: 'cors'
//         }).then(async (e) => {
//             return e.json()
//         }).then((e) => {
//             console.log("最终结果:", e)
//         })
    </script>
</body>

</html>